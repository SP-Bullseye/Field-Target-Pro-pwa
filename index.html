<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Field Target Pro</title>
  <meta name="theme-color" content="#071021">
  <meta name="robots" content="noindex, nofollow">

  <!-- Favicon and PWA icons -->
  <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
  <link rel="manifest" href="manifest.json">

  <style>
    /* Global styles */
    body { margin:0; font-family: sans-serif; background: #071021; color: white; }

    /* Startup screen */
    #startup { 
      display: flex; flex-direction: column; justify-content: center; align-items: center;
      width: 100vw; height: 100vh; text-align: center;
    }
    #startup .title { font-size: 3rem; margin-bottom: 1rem; }

    /* App container */
    #app { display: none; padding: 1rem; max-width: 600px; margin: auto; }

    /* Calculator */
    .calculator input { width: 80px; margin-right: 10px; }
    #output { margin-top: 1rem; font-weight: bold; }

    /* Target animation */
    .target-container { position: relative; width: 150px; height: 150px; margin: 2rem auto; }
    .field-target { width: 100%; height: 100%; background: radial-gradient(circle, #222 50%, #444 100%); border-radius: 50%; position: relative; }
    .ft-text { position: absolute; top:50%; left:50%; transform: translate(-50%,-50%); font-size:2rem; }
    .kill-zone { position: absolute; width: 50px; height: 50px; top:50%; left:50%; transform: translate(-50%,-50%); border-radius:50%; background: rgba(255,0,0,0.2); }
    .splatter { position: absolute; width: 0; height: 0; border-radius:50%; background: rgba(255,0,0,0.8); transition: all 0.3s ease; }
    .base-plate { width: 100%; height: 10px; background: #333; margin-top: 5px; border-radius:5px; }

    /* Simple fade-in animation for app */
    #app.fade-in { animation: fadeIn 1s forwards; }
    @keyframes fadeIn { from {opacity:0;} to {opacity:1;} }
  </style>
</head>
<body>

  <!-- Startup screen -->
  <div id="startup">
    <div class="title">Field Target Pro</div>
    <audio id="clangSound" preload="auto">
      <source src="https://actions.google.com/sounds/v1/metal/metal_hit_bell.ogg" type="audio/ogg">
    </audio>
  </div>

  <!-- Main app -->
  <div id="app">
    <div class="target-container">
      <div class="field-target">
        <div class="ft-text">FT</div>
        <div class="kill-zone">
          <div class="splatter" id="splatter"></div>
        </div>
      </div>
      <div class="base-plate"></div>
    </div>

    <div class="calculator">
      <label>Pallet Weight (grains): <input type="number" id="pelletWeight" value="14"></label>
      <label>Velocity (fps): <input type="number" id="velocity" value="900"></label>
      <label>Range (m): <input type="number" id="range" value="20"></label>
      <label>Scope Height (mm): <input type="number" id="scopeHeight" value="25"></label>
      <button onclick="calculate()">Calculate</button>
    </div>

    <div id="output"></div>
  </div>

  <script>
    const clang = document.getElementById('clangSound');
    const startup = document.getElementById('startup');
    const app = document.getElementById('app');
    const splatter = document.getElementById('splatter');

    // Play clang sound after 1s (catch autoplay errors)
    setTimeout(() => clang.play().catch(e => console.log(e)), 1000);

    // Hide startup screen & show app after 5.5s
    setTimeout(() => {
      startup.style.display = 'none';
      app.style.display = 'block';
      app.classList.add('fade-in');
    }, 5500);

    // Calculator logic
    function calculate() {
      const w = parseFloat(document.getElementById('pelletWeight').value);
      const v = parseFloat(document.getElementById('velocity').value);
      const range = parseFloat(document.getElementById('range').value);
      const scope = parseFloat(document.getElementById('scopeHeight').value);
      const g = 9.81;
      const m = w * 0.0000648; // kg
      const energy = 0.5 * m * Math.pow(v * 0.3048, 2); // J
      const drop = 0.5 * g * Math.pow(range / (v * 0.3048), 2); // m
      document.getElementById('output').innerHTML = `
        <strong>Results:</strong><br>
        Muzzle Energy: ${energy.toFixed(2)} J<br>
        Pellet Drop: ${(drop*100).toFixed(1)} cm<br>
        Scope Offset: ~${scope} mm
      `;

      // Simple splatter animation on calculation
      splatter.style.width = '50px';
      splatter.style.height = '50px';
      setTimeout(() => { splatter.style.width = '0'; splatter.style.height = '0'; }, 500);
    }

    // Service Worker registration
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('sw.js')
        .then(() => console.log('Service Worker Registered'))
        .catch(err => console.error('Service Worker failed:', err));
    }
  </script>
</body>
</html>
